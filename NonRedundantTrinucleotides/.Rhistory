ibrary(veriNA3d)
library(dplyr)
library(tidyverse)
library(ggplot2)
pdb <- c("1bau", "2z75", "165d", "3nkb", "4zlr")
#Download PDB from Proein Data Bank
ntinfo <- pipeNucData(pdbID = pdb)
#Create a dataframe with the trinucleotide level and the frequency
trin <- as.data.frame(table(ntinfo$localenv))
#Remove all identifiers that do contain aberrant modifications or extremes
ntd <- ntinfo$localenv[grep("^[AUCG]-[AUGC]-[AUGC]$", ntinfo$localenv, perl=T)]
Nucleotide <- droplevels(ntd)
plat <- as.data.frame(table(Nucleotide))
plat2 <- plat %>%
arrange(desc(Freq))
#Create ggplot. Seems not to sort data in a descending or ascending way
ggplot(plat2, aes(x = Nucleotide, y = Freq)) + geom_point() + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
#-----------------------------------
#Create the data frame with ascending order data
sorted <- data.frame(reorder(plat2$Nucleotide, plat2$Freq))
names(sorted) <- paste("Nucleotide")
sorted_data <- data.frame (Nucleotide = sorted, Freq = plat2$Freq)
#Crete the plot with ascending order data
ggplot(sorted_data, aes(x = Nucleotide, y = Freq)) + geom_point() + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
library(veriNA3d)
library(dplyr)
library(tidyverse)
library(ggplot2)
pdb <- c("1bau", "2z75", "165d", "3nkb", "4zlr")
#Download PDB from Proein Data Bank
ntinfo <- pipeNucData(pdbID = pdb)
#Create a dataframe with the trinucleotide level and the frequency
trin <- as.data.frame(table(ntinfo$localenv))
#Remove all identifiers that do contain aberrant modifications or extremes
ntd <- ntinfo$localenv[grep("^[AUCG]-[AUGC]-[AUGC]$", ntinfo$localenv, perl=T)]
Nucleotide <- droplevels(ntd)
plat <- as.data.frame(table(Nucleotide))
plat2 <- plat %>%
arrange(desc(Freq))
#Create ggplot. Seems not to sort data in a descending or ascending way
ggplot(plat2, aes(x = Nucleotide, y = Freq)) + geom_point() + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
#-----------------------------------
#Create the data frame with ascending order data
sorted <- data.frame(reorder(plat2$Nucleotide, plat2$Freq))
names(sorted) <- paste("Nucleotide")
sorted_data <- data.frame (Nucleotide = sorted, Freq = plat2$Freq)
#Crete the plot with ascending order data
ggplot(sorted_data, aes(x = Nucleotide, y = Freq)) + geom_point() + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
#Create ggplot. Seems not to sort data in a descending or ascending way
ggplot(plat2, aes(x = Nucleotide, y = Freq)) + geom_bar() + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
#Create ggplot. Seems not to sort data in a descending or ascending way
ggplot(plat2, aes(x = Nucleotide)) + geom_bar() + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
#Create ggplot. Seems not to sort data in a descending or ascending way
ggplot(plat2, aes(x = Nucleotide, y = Freq)) + geom_bar(stat = 'identity') + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
#Crete the plot with ascending order data
ggplot(sorted_data, aes(x = Nucleotide, y = Freq)) + geom_point(stat = "identity") + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
#Crete the plot with ascending order data
ggplot(sorted_data, aes(x = Nucleotide, y = Freq)) + geom_bar(stat = "identity") + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
plat2 <- plat %>%
arrange(desc(Freq))
plat2
str(plat2)
#Create ggplot. Seems not to sort data in a descending or ascending way
ggplot(plat2, aes(x = Nucleotide, y = Freq)) + geom_bar(stat = 'identity') + theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),vjust =1))
?reorder
